<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.ajax4jsf.org/rich"
	template="#{theme.template3cols}">

	<ui:define name="title">
		<title>#{messages['manage.editmic.browserTitle']}</title>
	</ui:define>

	<ui:define name="pagetabs">
		<ui:include src="#{theme.pagetabs}">
			<ui:param name="activeTab" value="manage" />
		</ui:include>
	</ui:define>

	<ui:define name="main">

		<s:fragment
			rendered="#{mediabaseItemDetails.class.name eq 'de.dvdb.domain.model.mediabase.MediabaseItemCollectible'}">

			<h1><h:outputText
				value="#{messages['manage.editmic.headline_add']}"
				rendered="#{mediabaseItemDetails.id eq null}" /> <h:outputText
				value="#{messages['manage.editmic.headline_edit']}"
				rendered="#{mediabaseItemDetails.id ne null}" /></h1>

			<h:form>

				<h2>Moviebase Details</h2>

				<p><h:panelGrid columns="2" styleClass="full">

					<h:panelGroup>
						<s:decorate template="/WEB-INF/inc/editField.xhtml">
							<ui:define name="label">#{messages['manage.editmic.position.legend']}</ui:define>
							<h:inputText value="#{mediabaseItemDetails.position}" />
						</s:decorate>
					</h:panelGroup>

					<h:panelGroup>
						<s:decorate template="/WEB-INF/inc/editField.xhtml">
							<ui:define name="label">Platzierung in Deiner Top 20:</ui:define>
							<h:selectOneMenu value="#{mediabaseItemDetails.topNPosition}">
								<f:selectItem itemValue="" itemLabel="nicht in Top 20" />
								<f:selectItem itemLabel="Platz 1" itemValue="1" />
								<f:selectItem itemLabel="Platz 2" itemValue="2" />
								<f:selectItem itemLabel="Platz 3" itemValue="3" />
								<f:selectItem itemLabel="Platz 4" itemValue="4" />
								<f:selectItem itemLabel="Platz 5" itemValue="5" />
								<f:selectItem itemLabel="Platz 6" itemValue="6" />
								<f:selectItem itemLabel="Platz 7" itemValue="7" />
								<f:selectItem itemLabel="Platz 8" itemValue="8" />
								<f:selectItem itemLabel="Platz 9" itemValue="9" />
								<f:selectItem itemLabel="Platz 10" itemValue="10" />
								<f:selectItem itemLabel="Platz 11" itemValue="11" />
								<f:selectItem itemLabel="Platz 12" itemValue="12" />
								<f:selectItem itemLabel="Platz 13" itemValue="13" />
								<f:selectItem itemLabel="Platz 14" itemValue="14" />
								<f:selectItem itemLabel="Platz 15" itemValue="15" />
								<f:selectItem itemLabel="Platz 16" itemValue="16" />
								<f:selectItem itemLabel="Platz 17" itemValue="17" />
								<f:selectItem itemLabel="Platz 18" itemValue="18" />
								<f:selectItem itemLabel="Platz 19" itemValue="19" />
								<f:selectItem itemLabel="Platz 20" itemValue="20" />
							</h:selectOneMenu>
						</s:decorate>
					</h:panelGroup>

					<h:outputLabel for="consumeCounter" value="Anzahl gesehen" />

					<h:outputLabel for="lastConsumeDate" value="Zuletzt am" />

					<h:panelGroup>
						<s:decorate>
							<h:inputText value="#{mediabaseItemDetails.consumeCounter}"
								id="consumeCounter">
							</h:inputText>
							<br />
							<h:message for="consumeCounter" />
						</s:decorate>
					</h:panelGroup>

					<h:panelGroup>
						<s:decorate>

							<rich:calendar id="lastConsumeDate" locale="de"
								style="width:250px" inputStyle="width:100px"
								value="#{mediabaseItemDetails.lastConsumeDate}"
								resetTimeOnDateSelect="false" datePattern="dd.M.yyyy"
								timeZone="#{dateTimeQueryHelper.timeZone}"
								enableManualInput="true" />

							<br />
							<h:message for="lastConsumeDate" />
						</s:decorate>
					</h:panelGroup>
				</h:panelGrid></p>


				<h2>DVD Details</h2>

				<p><h:panelGrid columns="4" styleClass="full">

					<h:outputLabel for="dateOfPurchase"
						value="#{messages['domain.mediabaseItemCollectible.label.dateOfPurchase']}" />

					<h:outputLabel for="purchasePrice"
						value="#{messages['domain.mediabaseItemCollectible.label.purchasePrice']} (bitte mit Punkt statt Komma):" />

					<h:outputLabel for="source" value="Erworben bei" />

					<h:outputLabel for="purchaseType"
						value="#{messages['domain.mediabaseItemCollectible.label.purchaseType']}" />

					<h:panelGroup>
						<s:decorate>

							<rich:calendar id="dateOfPurchase" locale="de"
								style="width:250px" inputStyle="width:100px"
								value="#{mediabaseItemDetails.dateOfPurchase}"
								resetTimeOnDateSelect="false" datePattern="dd.M.yyyy"
								timeZone="#{dateTimeQueryHelper.timeZone}"
								enableManualInput="true" />

							<br />
							<h:message for="dateOfPurchase" />
						</s:decorate>
					</h:panelGroup>

					<h:panelGroup>
						<s:decorate>
							<h:inputText value="#{mediabaseItemDetails.purchasePrice}"
								size="12" style="width:100px" id="purchasePrice">
							</h:inputText>
							<br />
							<h:message for="purchasePrice" />
						</s:decorate>
					</h:panelGroup>

					<h:panelGroup>
						<s:decorate>
							<h:inputText value="#{mediabaseItemDetails.purchaseShop}"
								size="12" style="width:150px" id="source" />
							<br />
							<h:message for="source" />
						</s:decorate>
					</h:panelGroup>

					<h:panelGroup>
						<h:selectOneMenu id="purchaseType"
							value="#{mediabaseItemDetails.purchaseType}" style="width:80%">

							<f:selectItem itemValue="1"
								itemLabel="#{messages['domain.mediabaseItemCollectible.purchaseType.value.none']}" />
							<f:selectItem itemValue="2"
								itemLabel="#{messages['domain.mediabaseItemCollectible.purchaseType.value.localshop']}" />
							<f:selectItem itemValue="3"
								itemLabel="#{messages['domain.mediabaseItemCollectible.purchaseType.value.onlineshop']}" />
							<f:selectItem itemValue="4"
								itemLabel="#{messages['domain.mediabaseItemCollectible.purchaseType.value.auction']}" />
							<f:selectItem itemValue="5"
								itemLabel="#{messages['domain.mediabaseItemCollectible.purchaseType.value.gift']}" />
							<f:selectItem itemValue="6"
								itemLabel="#{messages['domain.mediabaseItemCollectible.purchaseType.value.gratis']}" />
							<f:selectItem itemValue="7"
								itemLabel="#{messages['domain.mediabaseItemCollectible.purchaseType.value.club']}" />
							<f:selectItem itemValue="8"
								itemLabel="#{messages['domain.mediabaseItemCollectible.purchaseType.value.swapped']}" />
							<f:selectItem itemValue="9"
								itemLabel="#{messages['domain.mediabaseItemCollectible.purchaseType.value.boerse']}" />
							<f:selectItem itemValue="10"
								itemLabel="#{messages['domain.mediabaseItemCollectible.purchaseType.value.videothek']}" />
							<f:selectItem itemValue="11"
								itemLabel="#{messages['domain.mediabaseItemCollectible.purchaseType.value.2ndhand']}" />
						</h:selectOneMenu>
					</h:panelGroup>

				</h:panelGrid></p>


				<p><s:decorate template="/WEB-INF/inc/editField.xhtml">
					<ui:define name="label">Lieferung steht noch aus</ui:define>

					<h:panelGroup>
						<h:selectOneRadio value="#{mediabaseItemDetails.status}">
							<f:selectItem itemValue="0" itemLabel="#{messages['general.no']}" />
							<f:selectItem itemValue="2"
								itemLabel="#{messages['general.yes']}" />
						</h:selectOneRadio>
					</h:panelGroup>
				</s:decorate></p>

				<h2>Sonstiges</h2>

				<p><s:decorate template="/WEB-INF/inc/editField.xhtml">
					<ui:define name="label">#{messages['domain.mediabaseItemCollectible.label.comment']}</ui:define>
					<h:inputTextarea rows="5" value="#{mediabaseItemDetails.comment}">
						<s:validateFormattedText />
					</h:inputTextarea>
				</s:decorate></p>

				<s:fragment rendered="true">
					<p><s:decorate template="/WEB-INF/inc/editCheckbox.xhtml">
						<ui:define name="label">Neue DVD/Blu-ray auf Facebook Wall posten?
						</ui:define>

						<s:fragment rendered="#{actor.user.facebookUserId ne null}">
							<h:selectBooleanCheckbox
								value="#{mediabaseItemAction.postToFacebook}" /> Ja
						</s:fragment>

						<s:fragment rendered="#{actor.user.facebookUserId eq null}">
							<h:outputLink
								value="http://www.facebook.com/apps/application.php?id=297453414110"
								target="_top">Hier klicken, um die neue dvdb.de Facebook Anwendung auszuprobieren</h:outputLink>
						</s:fragment>

					</s:decorate></p>
				</s:fragment>

				<p><h:panelGrid columns="2" styleClass="full">
					<h:panelGroup>
						<h:commandButton action="#{mediabaseItemAction.persist}"
							rendered="#{mediabaseItemDetails.id eq null}"
							value="#{messages['manage.editmic.action.add']}"
							styleClass="primaryAction" />
						<h:commandButton action="#{mediabaseItemAction.update}"
							rendered="#{mediabaseItemDetails.id ne null}"
							value="#{messages['manage.editmic.action.update']}"
							styleClass="primaryAction">
						</h:commandButton>
					</h:panelGroup>

					<h:panelGroup>
						<h:commandButton action="#{mediabaseItemAction.remove}"
							onclick="if (! window.confirm('#{messages['manage.remove.confirmation']}') ) {return false}"
							immediate="true" rendered="#{mediabaseItemDetails.id ne null}"
							value="#{messages['manage.editmic.action.remove']}" />
					</h:panelGroup>
				</h:panelGrid></p>

			</h:form>

			<h:form>

				<h2>#{messages['manage.editmic.headline.borrowManagement']}</h2>

				<p><h:outputLabel for="search"
					value="#{messages['manage.editmic.label.buddy.headline']}" /><br />

				<h:panelGroup
					rendered="#{mediabaseItemDetails.borrowedToBuddy ne null}">
					<h:inputText value="#{mediabaseItemDetails.borrowedToBuddy.name}"
						readonly="true" />
				</h:panelGroup> <h:panelGroup
					rendered="#{mediabaseItemDetails.borrowedToBuddy eq null}">

					<p><s:decorate template="/WEB-INF/inc/editField.xhtml">
						<ui:define name="label">#{messages['manage.editmic.label.buddy.name']}</ui:define>
						<h:inputText value="#{searchBuddyController.searchString}"
							id="search"
							validator="#{searchBuddyController.validateExistingBuddy}"
							required="true" />
					</s:decorate></p>

					<s:link action="#{buddyAction.createBuddy}">
						<h:graphicImage value="/img/icons/22x22/add_user.png" width="22"
							height="22" />
					</s:link>

					<rich:suggestionbox id="suggestionBoxId" for="search"
						suggestionAction="#{searchBuddyController.suggest}" var="userVar"
						fetchValue="#{userVar.name}" minChars="2"
						nothingLabel="#{messages['manage.editmic.result.noBuddyMatch']}">
						<h:column>
							<h:outputText value="#{userVar.name}" />
						</h:column>
					</rich:suggestionbox>

				</h:panelGroup>
				<div class="actions"><h:commandButton
					action="#{mediabaseItemAction.borrowedReturned}"
					value="#{messages['manage.editmic.action.gotBack']}"
					rendered="#{mediabaseItemDetails.borrowedToBuddy ne null}" /> <h:commandButton
					action="#{mediabaseItemAction.borrowed}"
					value="#{messages['manage.editmic.action.saveBorrow']}"
					rendered="#{mediabaseItemDetails.borrowedToBuddy eq null}" /></div>

				</p>

			</h:form>

		</s:fragment>


		<s:fragment
			rendered="#{mediabaseItemDetails.class.name eq 'de.dvdb.domain.model.mediabase.MediabaseItemWish'}">

			<h1><h:outputText
				value="#{messages['manage.editmiw.headline_add']}"
				rendered="#{mediabaseItemDetails.id eq null}" /> <h:outputText
				value="#{messages['manage.editmiw.headline_edit']}"
				rendered="#{mediabaseItemDetails.id ne null}" /></h1>

			<h:form>

				<p><s:decorate template="/WEB-INF/inc/editField.xhtml">
					<ui:define name="label">Wunschintensitaet:</ui:define>
					<h:selectOneMenu value="#{mediabaseItemDetails.intensity}">
						<f:selectItem itemValue="" itemLabel="keine Angabe" />
						<f:selectItem itemLabel="+" itemValue="1" />
						<f:selectItem itemLabel="++" itemValue="2" />
						<f:selectItem itemLabel="+++" itemValue="3" />
						<f:selectItem itemLabel="++++" itemValue="4" />
						<f:selectItem itemLabel="+++++" itemValue="5" />
					</h:selectOneMenu>
				</s:decorate></p>

				<p><s:decorate template="/WEB-INF/inc/editField.xhtml">
					<ui:define name="label">#{messages['manage.editmiw.maximalPrice.legend']} (bitte mit Punkt statt Komma):</ui:define>
					<h:inputText value="#{mediabaseItemDetails.maximumPurchasePrice}" />
				</s:decorate></p>

				<p><s:decorate template="/WEB-INF/inc/editCheckbox.xhtml">
					<ui:define name="label">Benachrichtigung bei Erreichen Deiner Preisgrenze:</ui:define>

					<h:selectBooleanCheckbox id="notify"
						disabled="#{!actor.user.newsletter}"
						value="#{mediabaseItemDetails.notify}" /> Ja
			</s:decorate> <s:fragment rendered="#{!actor.user.newsletter}">
					<div class="wichtig">Du hast in Deinen<h:outputText value=" " /><s:link
						view="/account/account.xhtml" value="Profileinstellungen"
						propagation="none" /> den Empfang von Newslettern deaktiviert.
					Der Empfang von Newslettern muss aber aktiviert sein, um
					Benachrichtigungen zu empfangen.</div>
				</s:fragment></p>


				<p><h:panelGrid columns="2" styleClass="full">
					<h:panelGroup>
						<h:commandButton action="#{mediabaseItemAction.persist}"
							rendered="#{mediabaseItemDetails.id eq null}"
							value="#{messages['manage.editmiw.action.add']}"
							styleClass="primaryAction" />
						<h:commandButton action="#{mediabaseItemAction.update}"
							rendered="#{mediabaseItemDetails.id ne null}"
							value="#{messages['manage.editmiw.action.update']}"
							styleClass="primaryAction">
						</h:commandButton>
					</h:panelGroup>

					<h:panelGroup>
						<h:commandButton action="#{mediabaseItemAction.remove}"
							onclick="if (! window.confirm('#{messages['general.remove.confirmation']}?') ) {return false}"
							immediate="true" rendered="#{mediabaseItemDetails.id ne null}"
							value="#{messages['manage.editmiw.action.remove']}" />
					</h:panelGroup>
				</h:panelGrid></p>

			</h:form>

		</s:fragment>

	</ui:define>

	<ui:define name="sidebar_left">
		<ui:include src="inc/sectionactions.xhtml" />
	</ui:define>

	<ui:define name="sidebar_right">
		<ui:include src="/discover/inc/sidebarTeaser.xhtml">
			<ui:param name="mediabaseItemVar" value="#{mediabaseItemDetails}" />
			<ui:param name="itemVar" value="#{itemDetails}" />
		</ui:include>
		<ui:include src="/discover/inc/sidebarActions.xhtml">
			<ui:param name="mediabaseItemVar" value="#{mediabaseItemDetails}" />
			<ui:param name="itemVar" value="#{itemDetails}" />
		</ui:include>
		<ui:include src="/discover/inc/sidebarStats.xhtml">
			<ui:param name="mediabaseItemVar" value="#{mediabaseItemDetails}" />
			<ui:param name="itemVar" value="#{itemDetails}" />
		</ui:include>
	</ui:define>
</ui:composition>
